<!-- users/dashboard.html -->
{% extends "base.html" %}

{% block content %}
  <h1>Welcome, {{ request.user.email }}!</h1>

  <h2>Your Entries</h2>
  <table>
    <thead>
      <tr>
        <th>Race</th>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Entry Date</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for entry in user_entries %}
        <tr>
          <td>{{ entry.race.name }}</td>
          <td>{{ entry.first_name }}</td>
          <td>{{ entry.last_name }}</td>
          <td>{{ entry.entry_date }}</td>
          <td>
            <form action="{% url 'users:cancel_entry' entry.id %}" method="post" style="display:inline;">
              {% csrf_token %}
              <button type="submit" onclick="return confirm('Are you sure you want to cancel this entry?');">Cancel</button>
            </form>
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="5">No entries found.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <h2>Your Payments</h2>
  <table>
    <thead>
      <tr>
        <th>Entry</th>
        <th>Amount</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody>
      {% for payment in user_payments %}
        <tr>
          <td>{{ payment.entry.race.name }}</td>
          <td>{{ payment.amount }}</td>
          <td>{{ payment.date }}</td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="3">No payments found.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
